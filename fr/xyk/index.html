<!doctype html>
<html lang="fr" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/fr/blog/rss.xml" title="HydraDX Docs Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/fr/blog/atom.xml" title="HydraDX Docs Blog Atom Feed"><title data-react-helmet="true">XYK Pallet | HydraDX Docs</title><meta data-react-helmet="true" property="og:url" content="https://docs.hydradx.io/fr/xyk"><meta data-react-helmet="true" name="docusaurus_locale" content="fr"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="XYK Pallet | HydraDX Docs"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="/fr/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://docs.hydradx.io/fr/xyk"><link data-react-helmet="true" rel="alternate" href="https://docs.hydradx.io/xyk" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.hydradx.io/de/xyk" hreflang="de"><link data-react-helmet="true" rel="alternate" href="https://docs.hydradx.io/ru/xyk" hreflang="ru"><link data-react-helmet="true" rel="alternate" href="https://docs.hydradx.io/es/xyk" hreflang="es"><link data-react-helmet="true" rel="alternate" href="https://docs.hydradx.io/fr/xyk" hreflang="fr"><link data-react-helmet="true" rel="alternate" href="https://docs.hydradx.io/cn/xyk" hreflang="cn"><link data-react-helmet="true" rel="alternate" href="https://docs.hydradx.io/xyk" hreflang="x-default"><link rel="stylesheet" href="/fr/assets/css/styles.c09fcbad.css">
<link rel="preload" href="/fr/assets/js/runtime~main.990c5a9e.js" as="script">
<link rel="preload" href="/fr/assets/js/main.f625d109.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Aller au contenu principal</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/fr/"><img src="/fr/img/logo.svg" alt="HydraDX logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/fr/img/logo.svg" alt="HydraDX logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Documentation HydraDX</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fr/">Documents</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>fran√ßais</span></span></a><ul class="dropdown__menu"><li><a href="/xyk" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/de/xyk" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">Deutsch</a></li><li><a href="/ru/xyk" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">—Ä—É—Å—Å–∫–∏–π</a></li><li><a href="/es/xyk" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">espa√±ol</a></li><li><a href="/fr/xyk" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">fran√ßais</a></li><li><a href="/cn/xyk" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">‰∏≠Êñá</a></li></ul></div><a href="https://hydradx.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Page d&#x27;accueil de HydraDX</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/fr/"><img src="/fr/img/logo.svg" alt="HydraDX logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/fr/img/logo.svg" alt="HydraDX logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Documentation HydraDX</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/fr/">Documents</a></li><li class="menu__list-item menu__list-item--collapsed"><a href="#" role="button" class="menu__link menu__link--sublist"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>Languages</span></span></a><ul class="menu__list"><li class="menu__list-item"><a href="/xyk" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">English</a></li><li class="menu__list-item"><a href="/de/xyk" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">Deutsch</a></li><li class="menu__list-item"><a href="/ru/xyk" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">—Ä—É—Å—Å–∫–∏–π</a></li><li class="menu__list-item"><a href="/es/xyk" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">espa√±ol</a></li><li class="menu__list-item"><a href="/fr/xyk" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active" style="text-transform:capitalize">fran√ßais</a></li><li class="menu__list-item"><a href="/cn/xyk" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">‰∏≠Êñá</a></li></ul></li><li class="menu__list-item"><a href="https://hydradx.io" target="_blank" rel="noopener noreferrer" class="menu__link">Page d&#x27;accueil de HydraDX</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Ouvrir le menu lat√©ral" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/">Commencer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/hydradx_crowdloan">HydraDX Crowdloan</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/snakenet">Snakenet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/new_deal">Contribuer et √™tre r√©compens√©</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Comment</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/create_account">Create a new HDX Account</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/claim">R√©cup√©rer vos HDX</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/start_nominating">Devenez nominateur</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/start_validating">Devenez validateur</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/identity">d√©finir votre identit√©</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/staking_claim_rewards">R√©cup√©rer vos r√©compenses de d√©l√©gation (staking rewards)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/tip_request">R√©clamer une r√©compense de tr√©sorerie</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/participate_in_referenda">Participate in Referenda</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/participate_in_council_elections">Participate in Council Elections</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Se connecter √† une Node</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/polkadotjs_apps_local">Se connecter √† un node local</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/polkadotjs_apps_public">Se connecter √† un node publique</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Apprendre</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/staking">Staking (d√©l√©guer)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/staking_rewards">R√©compenses de d√©l√©gation (staking)</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Democracy</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/democracy_intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/democracy_referenda">Referenda</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/democracy_council">HydraDX Council</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/democracy_technical_committee">Technical Committee</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Maintenance</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/node_setup">Installer un node HydraDX</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/performance_benchmark">Benchmark de performance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/node_monitoring">Supervision de node</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Build</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fr/dev_intro">Intro to Development</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fr/build_dev_chain">Configurer une cha√Æne de d√©veloppement</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fr/dev_pools">AMM Pools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fr/dev_primitives">Primitives Crate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fr/dev_math">HydraDX Math Crate</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Pallets</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fr/dev_pallets">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fr/registry">Asset Registry</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/fr/xyk">XYK Pallet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fr/dev_pallet_hdx">HDX Pallet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fr/dev_pallet_exchange">Exchange</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fr/dev_pallet_payment">Transaction Multi-Payment</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/fr/dev_exercise">Practical exercise</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contribuer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/fr/contributing">Writing Docs</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">XYK Pallet</h1></header><div class="markdown"><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Lien direct vers le titre">#</a></h3><p>Uniswap AMM model implementation.</p><p>This pallet also implements the AMM trait which makes it possible to plug it into exchange pallet.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="config"></a>Config<a class="hash-link" href="#config" title="Lien direct vers le titre">#</a></h3><p>Config is pretty straight-forward.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub trait Config: frame_system::Config + pallet_asset_registry::Config {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type Event: From&lt;Event&lt;Self&gt;&gt; + IsType&lt;&lt;Self as frame_system::Config&gt;::Event&gt;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// Share token support</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type AssetPairAccountId: AssetPairAccountIdFor&lt;AssetId, Self::AccountId&gt;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// Multi currency for transfer of currencies</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type Currency: MultiCurrencyExtended&lt;Self::AccountId, CurrencyId = AssetId, Balance = Balance, Amount = Amount&gt;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// Native Asset Id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type NativeAssetId: Get&lt;AssetId&gt;;    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// Weight information for the extrinsics.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type WeightInfo: WeightInfo;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /// Trading fee rate</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type GetExchangeFee: Get&lt;fee::Fee&gt;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copier le code" class="copyButton_Ue-o">Copier</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="storage"></a>Storage<a class="hash-link" href="#storage" title="Lien direct vers le titre">#</a></h3><p>A pool is created for each asset pair. Information about the existing pools is kept in the following storage structures:</p><p><em>ShareToken</em></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub type ShareToken&lt;T: Config&gt; = StorageMap&lt;_, Blake2_128Concat, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    T::AccountId, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    AssetId, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ValueQuery&gt;;</span></div></div></div><button type="button" aria-label="Copier le code" class="copyButton_Ue-o">Copier</button></div></div><p>Mapping between a pool account and an asset id obtained from the registry.</p><p><em>PoolAssets</em></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub type PoolAssets&lt;T: Config&gt; = StorageMap&lt;_, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Blake2_128Concat, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    T::AccountId, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    (AssetId, AssetId), </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ValueQuery&gt;;</span></div></div></div><button type="button" aria-label="Copier le code" class="copyButton_Ue-o">Copier</button></div></div><p>Mapping between a pool account and a tuple of assets in this pool. This is useful only when listing existing pools and their assets (eg. for FE).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="extrinsics"></a>Extrinsics<a class="hash-link" href="#extrinsics" title="Lien direct vers le titre">#</a></h3><p>This pallet has the following extrinsics:</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="create_pool"></a>create_pool<a class="hash-link" href="#create_pool" title="Lien direct vers le titre">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#[pallet::weight(&lt;T as Config&gt;::WeightInfo::create_pool())]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#[transactional]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub fn create_pool(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    origin: OriginFor&lt;T&gt;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    asset_a: AssetId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    asset_b: AssetId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    amount: Balance,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    initial_price: Price,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">) -&gt; DispatchResultWithPostInfo {}</span></div></div></div><button type="button" aria-label="Copier le code" class="copyButton_Ue-o">Copier</button></div></div><p>As the name suggests, this creates a pool between asset A and asset B (if such pool does not already exist) with initial liquidity determined by the amount and initial price.
It generates a name for this asset pair and asks the registry to return an id for the name (either assigning a new one or reusing a previously assigned name, if such pool existed).</p><p>It also constructs a pool account for this pair and stores the mapping in storage under ShareToken as described above. </p><p>You may ask &quot;How do we know the account if we add liquidity for example&quot;? Constructing the pool account id is deterministic, so adding liquidity into the pool of  asset A and B would generate the same account id. This is demonstrated in the following example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">fn from_assets(asset_a: AssetId, asset_b: AssetId) -&gt; T::AccountId {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    let mut buf = Vec::new();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    buf.extend_from_slice(b&quot;hydradx&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if asset_a &lt; asset_b {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        buf.extend_from_slice(&amp;asset_a.to_le_bytes());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        buf.extend_from_slice(&amp;asset_b.to_le_bytes());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        buf.extend_from_slice(&amp;asset_b.to_le_bytes());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        buf.extend_from_slice(&amp;asset_a.to_le_bytes());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    T::AccountId::unchecked_from(T::Hashing::hash(&amp;buf[..]))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copier le code" class="copyButton_Ue-o">Copier</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="add_liquidity"></a>add_liquidity<a class="hash-link" href="#add_liquidity" title="Lien direct vers le titre">#</a></h4><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="remove_liquidity"></a>remove_liquidity<a class="hash-link" href="#remove_liquidity" title="Lien direct vers le titre">#</a></h4><p>Add and remove liquidity are pretty straight-forward and easy to understand by checking the implementation.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="buy--sell"></a>buy / sell<a class="hash-link" href="#buy--sell" title="Lien direct vers le titre">#</a></h4><p>Probably the most interesting part of the pallet. Sell and buy are very similar however they differ in few minor details - what and how is checked
when resolving the transaction (mostly multiple limits).</p><p>Sell:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#[pallet::weight(&lt;T as Config&gt;::WeightInfo::sell())]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub fn sell(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    origin: OriginFor&lt;T&gt;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    asset_in: AssetId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    asset_out: AssetId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    amount: Balance,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    min_limit: Balance,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    discount: bool,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">) -&gt; DispatchResultWithPostInfo {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    let who = ensure_signed(origin)?;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Self as AMM&lt;_, _, _, _&gt;&gt;::sell(&amp;who, AssetPair { asset_in, asset_out }, amount, min_limit, discount)?;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Ok(().into())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copier le code" class="copyButton_Ue-o">Copier</button></div></div><p>In the case of sell, the user specifies min_limit of an asset_out which should be exchanged for a certain amount of asset_in.</p><p>buy:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#[pallet::weight(&lt;T as Config&gt;::WeightInfo::buy())]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub fn buy(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    origin: OriginFor&lt;T&gt;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    asset_out: AssetId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    asset_in: AssetId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    amount: Balance,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    max_limit: Balance,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    discount: bool,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">) -&gt; DispatchResultWithPostInfo {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    let who = ensure_signed(origin)?;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Self as AMM&lt;_, _, _, _&gt;&gt;::buy(&amp;who, AssetPair { asset_in, asset_out }, amount, max_limit, discount)?;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Ok(().into())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copier le code" class="copyButton_Ue-o">Copier</button></div></div><p>In the case of buy, the user specifies max_limit of an asset_in to be exchanged for a certain amount of asset_out.</p><p>If you look at the implementation of the buy/sell functions, you will see that they make calls under the hood to the AMM trait implementation for this pallet. This helps with avoiding code duplication and making this pallet easily usable in an exchange.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/galacticcouncil/HydraDX-docs/edit/main/docs/dev_pallet_xyk.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>√âditer cette page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Pagination des documents"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/fr/registry"><div class="pagination-nav__sublabel">Pr√©c√©dent</div><div class="pagination-nav__label">¬´ Asset Registry</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/fr/dev_pallet_hdx"><div class="pagination-nav__sublabel">Suivant</div><div class="pagination-nav__label">HDX Pallet ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#config" class="table-of-contents__link">Config</a></li><li><a href="#storage" class="table-of-contents__link">Storage</a></li><li><a href="#extrinsics" class="table-of-contents__link">Extrinsics</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Communaut√©</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/HDNPFFrcnW" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/hydra_dx" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Tous droits r√©serv√©s ¬© 2021 Intergalactic, Inc. Construit avec Docusaurus.</div></div></div></footer></div>
<script src="/fr/assets/js/runtime~main.990c5a9e.js"></script>
<script src="/fr/assets/js/main.f625d109.js"></script>
</body>
</html>